<toast></toast>
<div class="container" ng-controller="modelosController as modelosc" ng-cloak cg-busy="{promise:ModelosPromise,message:'Cargando...',templateUrl:'scripts/vendor/angular-busy/angular-busy.html'}">
    <div class="row">
        <div class="col-md-12">
            <h2>Lista de Modelos</h2>
        </div>
    </div>
    <div class="row button-margin">
        <div class="col-md-12">
            <button class="btn btn-primary" type="button" ng-disabled="modelosc.selectedItem.id !=''" ng-click="" ng-model="modelosc.isAddNewModelo"
                uib-btn-checkbox btn-checkbox-true="true" btn-checkbox-false="false">
		        <span class="glyphicon glyphicon-certificate" aria-hidden="true"></span> Agregar Nuevo
            </button>
        </div>
    </div>
    <div class="row" ng-class="{true:'item-visible', false: 'item-no-visible'}[modelosc.isAddNewModelo==true]">
        <div class="col-md-12">
            <form name="newModeloForm" ng-submit="" novalidate>
                <div ng-class="{ 'has-error': newModeloForm.nombre.$touched && newModeloForm.nombre.$invalid}" class="form-group">
                    <label for="nombre">Nombre</label>
                    <input type="text" name="nombre" class="form-control" ng-model="modelosc.newItem.nombre" placeholder="Nombre" required/>
                    <div class="help-block" ng-messages="newModeloForm.nombre.$error" ng-if="newModeloForm.nombre.$touched">
                        <p ng-message="required">"Nombre" es requerido.</p>
                    </div>
                </div>
                <div class="form-group">
                    <label for="observacion">Observación</label>
                    <textarea rows="" cols="" name="observacion" class="form-control" ng-model="modelosc.newItem.observacion" placeholder="Observación"></textarea>
                </div>
                <div class="form-group" ng-class="{ 'has-error': newModeloForm.marca.$touched && newModeloForm.marca.$invalid}">
                    <label for="marca">Marca</label>
                    <div class="input-group">
                        <select id="MarcaSelector" class="form-control input-group" name="marca" ng-model="modelosc.newItem.marca"  ng-options="marca as marca.marNombre for marca in modelosc.marcas track by marca.marId" required>
                            <option value="">--Seleccione Marca--</option>
                        </select>
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button" ng-click="modelosc.getMarcas()"><span class="glyphicon glyphicon-refresh" aria-hidden="true" ></span></button>
                        </span>
                    </div>
                    <div class="help-block" ng-messages="newModeloForm.marca.$error" ng-if="newModeloForm.marca.$touched">
                        <p ng-message="required">"Marca" es requerido.</p>
                    </div>
                </div>
                <div class="form-group">
                    <button type="button" class="btn btn-success" ng-click="modelosc.addModelo(modelosc.newItem.nombre,modelosc.newItem.marca,modelosc.newItem.observacion)"
                        ng-disabled="newModeloForm.$invalid">
			            <span class="glyphicon glyphicon-ok-sign" aria-hidden="true" ></span>
                        <span class="button-text">Agregar</span>
			        </button>
                </div>
            </form>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="input-group">
                <input type="text" class="form-control" placeholder="Buscar en todos los Modelos..." ng-model="modelosc.searchText" on-enter="modelosc.getModelos(QtyPagesSelected,1,modelosc.searchText)">
                <span class="input-group-btn">
		        <button class="btn btn-default btn-left-margin-2" type="button" ng-class="{true:'item-visible', false: 'item-no-visible'}[modelosc.searchText !='']" ng-click="modelosc.searchText=''">
		        	<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                </button>
                </span>
                <span class="input-group-btn">
		        <button class="btn btn-default btn-left-margin-2" type="button" ng-click="modelosc.getModelos(QtyPagesSelected,1,modelosc.searchText)">
		        	<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                </button>
                </span>
            </div>
        </div>
        <div class="col-md-2 col-md-offset-4">
            <input type="text" class="form-control" id="txtFilter" placeholder="Filtro" ng-model="modelosc.filter">
        </div>
    </div>
    <div class="row">
        <hr>
    </div>
    <div class="row">
        <table class="table table-hover" ng-cloak>
            <thead>
                <tr>
                    <th><span class="btn" ng-class="{true:'bold-text',false:''}[modelosc.orderBy=='modId']" ng-click="modelosc.changeOrderByOrDirection('modId')"><span ng-show="modelosc.orderBy=='modId'" ng-class="{true:'glyphicon glyphicon-sort-by-alphabet', false:'glyphicon glyphicon-sort-by-alphabet-alt'}[modelosc.orderDirection==false && modelosc.orderBy=='modId']"></span>                        ID</span>
                    </th>
                    <th><span class="btn" ng-class="{true:'bold-text',false:''}[modelosc.orderBy=='modNombre']" ng-click="modelosc.changeOrderByOrDirection('modNombre')"><span ng-show="modelosc.orderBy=='modNombre'" ng-class="{true:'glyphicon glyphicon-sort-by-alphabet', false:'glyphicon glyphicon-sort-by-alphabet-alt'}[modelosc.orderDirection==false && modelosc.orderBy=='modNombre']"></span>                        Nombre</span>
                    </th>
                    <th><span class="btn" ng-class="{true:'bold-text',false:''}[modelosc.orderBy=='marcaMar']" ng-click="modelosc.changeOrderByOrDirection('marcaMar')"><span ng-show="modelosc.orderBy=='marcaMar'" ng-class="{true:'glyphicon glyphicon-sort-by-alphabet', false:'glyphicon glyphicon-sort-by-alphabet-alt'}[modelosc.orderDirection==false && modelosc.orderBy=='marcaMar']"></span>                        Marca</span>
                    </th>
                    <th><span class="btn" ng-class="{true:'bold-text',false:''}[modelosc.orderBy=='modObservacion']" ng-click="modelosc.changeOrderByOrDirection('modObservacion')"><span ng-show="modelosc.orderBy=='modObservacion'" ng-class="{true:'glyphicon glyphicon-sort-by-alphabet', false:'glyphicon glyphicon-sort-by-alphabet-alt'}[modelosc.orderDirection==false && modelosc.orderBy=='modObservacion']"></span>                        Observación</span>
                    </th>
                    <th><span class="btn">Acción</span></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat-start="modelo in modelosc.modelos | orderObjectBy: modelosc.orderBy : modelosc.orderDirection | filter : modelosc.filter">
                    <td class="">{{modelo.modId}}</td>
                    <td class="">{{modelo.modNombre}}</td>
                    <td class="">{{modelo.marcaMar.marNombre}}</td>
                    <td class="">{{modelo.modObservacion}}</td>
                    <td class="action-buttons-td">
                        <button type="button" class="btn btn-primary" ng-model="modelosc.selectedItem.id" uib-btn-checkbox btn-checkbox-true="modelo.modId"
                            btn-checkbox-false="0" ng-click="modelosc.copyRowData(modelo.modNombre,modelo.marcaMar,modelo.modObservacion)">
                                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                <span class="button-text">Editar</span>
						    </button>
                        <button type="button" class="btn btn-danger" ng-disabled="modelosc.selectedItem.id == modelo.modId" ng-click="modelosc.removeModelo(modelo.modId)"
                            confirm="¿Está seguro de eliminar el registro?. Esta acción no se puede deshacer." confirm-title="Atención"
                            confirm-ok="Si" confirm-cancel="No">
                                <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                                <span class="button-text">Eliminar</span>
						    </button>
                    </td>
                </tr>
                <tr ng-repeat-end ng-class="{true:'row-visible', false: 'row-no-visible'}[modelosc.selectedItem.id == modelo.modId]">
                    <td>
                        <strong>Editando Modelo ID: {{modelo.modId}}</strong>
                    </td>
                    <td>
                        <form name="updateNameForm" ng-submit="" novalidate>
                            <div ng-class="{ 'has-error': updateNameForm.nombre.$touched && updateNameForm.nombre.$invalid}">
                                <input type="text" name="nombre" class="form-control" ng-model="modelosc.selectedItem.nombre" placeholder={{modelosc.modNombre}}
                                    required/>
                                <div class="help-block" ng-messages="updateNameForm.nombre.$error" ng-if="updateNameForm.nombre.$touched">
                                    <p ng-message="required">"Nombre" es requerido.</p>
                                </div>
                            </div>
                        </form>
                    </td>
                    <td>
                        <select id="MarcaSelector" class="form-control input-group" name="marca" ng-model="modelosc.selectedItem.marca"  ng-options="marca as marca.marNombre for marca in modelosc.marcas track by marca.marId" required>
                        </select>
                    </td>
                    <td>
                        <input type="text" name="observacion" class="form-control" ng-model="modelosc.selectedItem.observacion" placeholder={{modelo.modObservacion}}/>
                    </td>
                    <td>
                        <button type="button" class="btn btn-success" ng-click="modelosc.updateModelo(modelo.modId,modelosc.selectedItem.nombre,modelosc.selectedItem.marca,modelosc.selectedItem.observacion)"
                            ng-disabled="updateNameForm.$invalid || updateMarcaForm.$invalid">
                                <span class="glyphicon glyphicon-ok-sign" aria-hidden="true" ></span>
                                <span class="button-text">Guardar</span>
				            </button>
                    </td>
                </tr>
            </tbody>
        </table>
        <hr>
    </div>
    <div class="row" ng-cloak ng-show="modelosc.allLoad">
        <form class="form-inline">
            <div class="form-group">
                <select class="form-control in-line-paginator" id="selQtyPages" ng-model="QtyPagesSelected" ng-change="modelosc.ChangeQtyPagesTables(QtyPagesSelected,modelosc.searchText)"
                    ng-init="QtyPagesSelected=QtyPageTables">
                        <option value=10>10</option>
                        <option value=20>20</option>
                        <option value=50>50</option>
                        <option value=100>100</option>
                        <option value=Todos>Todos</option>
				    </select>
            </div>
            <div class="form-group">
                <ul uib-pagination previous-text="Anterior" next-text="Siguiente" items-per-page="QtyPageTables" total-items="modelosc.totalModelos"
                    ng-model="modelosc.CurrentPage" ng-change="modelosc.setPage(modelosc.CurrentPage)"></ul>
            </div>
            <div class="form-group pull-right actual-range" ng-cloak>
                {{modelosc.actualRange}}
            </div>
        </form>
    </div>
    Valor de marca: {{modelosc.selectedItem.marca}}
</div>