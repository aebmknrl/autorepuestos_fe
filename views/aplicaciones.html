<toast></toast>
<div class="container" ng-controller="aplicacionesController as aplicacionesc" ng-cloak cg-busy="{promise:AplicacionesPromise,message:'Cargando...',templateUrl:'scripts/vendor/angular-busy/angular-busy.html'}">
    <div ng-class="aplicacionesc.editing == true  ? 'item-no-visible' : 'item-visible'">
        <div class="row">
            <div class="col-md-12">
                <h2>Aplicaciones</h2>
            </div>
        </div>
        <div class="row button-margin">
            <div class="col-md-12">
                <button class="btn btn-primary" type="button" ng-disabled="(aplicacionesc.selectedItemAction == 'edit') || (aplicacionesc.selectedItemAction == 'view')"
                    ng-model="aplicacionesc.isAddNewAplicacion" uib-btn-checkbox btn-checkbox-true="true" btn-checkbox-false="false">
                    <span class="glyphicon glyphicon-certificate" aria-hidden="true"></span> Agregar Aplicación
                </button>
            </div>
        </div>
        <div class="row" ng-class="{true:'item-visible', false: 'item-no-visible'}[aplicacionesc.isAddNewAplicacion==true]">
            <div class="col-md-12 text-center">
                <h3>Nueva Aplicación de Parte</h3>
            </div>
        </div>
        <div class="row" ng-class="{true:'item-visible', false: 'item-no-visible'}[aplicacionesc.isAddNewAplicacion==true]">
            <div class="col-md-5">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">Parte a aplicar</h3>
                        <span class="pull-right clickable"><i class="fa fa-cog"></i></span>
                    </div>
                    <div class="panel-body">
                        <ui-select ng-model="aplicacionesc.parteSeleccionada" theme="bootstrap">
                            <ui-select-match placeholder="Seleccione una parte...">{{$select.selected.parNombre.parNombre}} {{$select.selected.parCodigo}}</ui-select-match>
                            <ui-select-choices group-by="aplicacionesc.selectParteGroup" repeat="parte in (aplicacionesc.partes | filter: $select.search) track by parte.parId">
                                <span ng-bind-html="parte.parNombre.parNombre | highlight: $select.search"></span>
                                <small ng-bind-html="parte.parCodigo | highlight: $select.search"></small>
                            </ui-select-choices>
                        </ui-select>
                    </div>
                </div>
            </div>
            <div class="col-md-2 text-center">
                <i class="fa fa-long-arrow-right large-simbol primary-text"></i>
            </div>
            <div class="col-md-5">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">Vehículo para la aplicación de parte</h3>
                        <span class="pull-right clickable"><i class="fa fa-car"></i></span>
                    </div>
                    <div class="panel-body">
                        <ui-select ng-model="aplicacionesc.vehiculosSeleccionados" multiple theme="bootstrap" ng-disabled="aplicacionesc.parteSeleccionada == null">
                            <ui-select-match placeholder="Seleccione los vehículos...">{{$item.modeloMod.marcaMar.marNombre}} {{$item.modeloMod.modNombre}}</ui-select-match>
                            <ui-select-choices group-by="aplicacionesc.selectVehiculoGroup" repeat="vehiculo in (aplicacionesc.vehiculos | filter: $select.search) track by vehiculo.vehId">
                                <span ng-bind-html="vehiculo.modeloMod.modNombre | highlight: $select.search"></span>
                                <small ng-bind-html="(vehiculo.vehCilindros == null ? '' : vehiculo.vehCilindros + '-') + ( vehiculo.vehLitros == null ? '' :  vehiculo.vehLitros + '-') + ( vehiculo.vehValvulas == null ? '' :  vehiculo.vehValvulas + '-') + ( vehiculo.vehLevas == null ? '' :  vehiculo.vehLevas + '-') + ( vehiculo.vehVersion == null ? '' :  vehiculo.vehVersion + '-') + ( vehiculo.vehFabDesde == null ? '' :  vehiculo.vehFabDesde + '-') + ( vehiculo.vehFabHasta == null ? 'Actual' :  vehiculo.vehFabHasta + '-')  | highlight: $select.search"></small>
                            </ui-select-choices>
                        </ui-select>
                    </div>
                </div>
            </div>
        </div>
        <div class="row" ng-class="{true:'item-visible', false: 'item-no-visible'}[aplicacionesc.isAddNewAplicacion==true]">
            <div class="col-md-12 text-center">
                <button class="btn btn-primary" type="button" ng-click="aplicacionesc.addAplicacion(aplicacionesc.parteSeleccionada.parId)">Agregar</button>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="input-group">
                <input type="text" class="form-control" placeholder="Buscar en todas las Aplicaciones..." ng-model="aplicacionesc.searchText"
                    on-enter="aplicacionesc.getAplicaciones(QtyPagesSelected,1,aplicacionesc.searchText)">
                <span class="input-group-btn">
		        <button class="btn btn-default btn-left-margin-2" type="button" ng-class="{true:'item-visible', false: 'item-no-visible'}[aplicacionesc.searchText !='']" ng-click="aplicacionesc.searchText=''">
		        	<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                </button>
                </span>
                <span class="input-group-btn">
		        <button class="btn btn-default btn-left-margin-2" type="button" ng-click="aplicacionesc.getAplicaciones(QtyPagesSelected,1,aplicacionesc.searchText)">
		        	<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                </button>
                </span>
            </div>
        </div>
        <div class="col-md-2 col-md-offset-4">
            <input type="text" class="form-control" id="txtFilter" placeholder="Filtro" ng-model="aplicacionesc.filter">
        </div>
    </div>
    <div class="row">
        <hr>
    </div>
    <div class="row">
        <table class="table table-hover" ng-cloak>
            <thead>
                <tr>
                    <th><span class="btn" ng-class="{true:'bold-text',false:''}[aplicacionesc.orderBy=='aplId']" ng-click="aplicacionesc.changeOrderByOrDirection('aplId')"><span ng-show="aplicacionesc.orderBy=='aplId'" ng-class="{true:'glyphicon glyphicon-sort-by-alphabet', false:'glyphicon glyphicon-sort-by-alphabet-alt'}[aplicacionesc.orderDirection==false && aplicacionesc.orderBy=='aplId']"></span>                        ID</span>
                    </th>
                    <th><span class="btn" ng-class="{true:'bold-text',false:''}[aplicacionesc.orderBy=='partePar.parNombre.parNombre']" ng-click="aplicacionesc.changeOrderByOrDirection('partePar.parNombre.parNombre')"><span ng-show="aplicacionesc.orderBy=='partePar.parNombre.parNombre'" ng-class="{true:'glyphicon glyphicon-sort-by-alphabet', false:'glyphicon glyphicon-sort-by-alphabet-alt'}[aplicacionesc.orderDirection==false && aplicacionesc.orderBy=='<partePar class="parNombre parNombre"></partePar>']"></span>                        Parte</span>
                    </th>
                    <th><span class="btn" ng-class="{true:'bold-text',false:''}[aplicacionesc.orderBy=='vehiculoVeh']" ng-click="aplicacionesc.changeOrderByOrDirection('vehiculoVeh')"><span ng-show="aplicacionesc.orderBy=='vehiculoVeh'" ng-class="{true:'glyphicon glyphicon-sort-by-alphabet', false:'glyphicon glyphicon-sort-by-alphabet-alt'}[aplicacionesc.orderDirection==false && aplicacionesc.orderBy=='vehiculoVeh']"></span>                        Vehículos</span>
                    </th>
                    <th><span class="btn">Acción</span></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="aplicacion in aplicacionesc.aplicaciones | orderObjectBy: aplicacionesc.orderBy : aplicacionesc.orderDirection | filter : aplicacionesc.filter">
                    <td class="">{{aplicacion.aplId}}</td>
                    <td class="">{{aplicacion.partePar.parNombre.parNombre}}</td>
                    <td class="">{{aplicacion.vehiculoVeh.veh}}</td>
                    <td class="action-buttons-td">
                        <button type="button" class="btn btn-primary" ng-click="aplicacionesc.openModalViewEdit(parte.parId,'view'); aplicacionesc.selectedItemAction='view';">
                                <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>
                                <span class="button-text">Ver</span>
                            </button>
                        <button type="button" class="btn btn-primary" ng-click="aplicacionesc.copyRowData(parte.parId); aplicacionesc.populateMultiselect(parte.parId);"
                            ng-disabled="aplicacionesc.selectedItemAction == 'view'">
                                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                <span class="button-text">Editar</span>
                            </button>
                        <button type="button" class="btn btn-danger" ng-click="aplicacionesc.removeParte(parte.parId)" confirm="¿Está seguro de eliminar el registro?. Esta acción no se puede deshacer."
                            confirm-title="Atención" confirm-ok="Si" confirm-cancel="No" ng-disabled="aplicacionesc.selectedItemAction == 'view'">
                                <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                                <span class="button-text">Eliminar</span>
                            </button>
                    </td>
                </tr>
            </tbody>
        </table>
        <hr>
    </div>
    <div class="row" ng-cloak ng-show="aplicacionesc.allLoad">
        <form class="form-inline">
            <div class="form-group">
                <select class="form-control in-line-paginator" id="selQtyPages" ng-model="QtyPagesSelected" ng-change="aplicacionesc.ChangeQtyPagesTables(QtyPagesSelected,aplicacionesc.searchText)"
                    ng-init="QtyPagesSelected=QtyPageTables">
                        <option value=10>10</option>
                        <option value=20>20</option>
                        <option value=50>50</option>
                        <option value=100>100</option>
                        <option value=Todos>Todos</option>
                        </select>
            </div>
            <div class="form-group">
                <ul uib-pagination previous-text="Anterior" next-text="Siguiente" items-per-page="QtyPageTables" total-items="aplicacionesc.totalPartes"
                    ng-model="aplicacionesc.CurrentPage" ng-change="aplicacionesc.setPage(aplicacionesc.CurrentPage)"></ul>
            </div>
            <div class="form-group pull-right actual-range" ng-cloak>
                {{aplicacionesc.actualRange}}
            </div>
        </form>
    </div>

</div>